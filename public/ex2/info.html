<!DOCTYPE html>
<html>

<head>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="bg-light text-center p-5 mb-4">
        <h2>Choose an option:</h2>
        <label for="limit">Limit:</label>
        <input onchange="getData()" id="limit" type="number" min=1 max=5 value=1>
        <select onchange="getData()" id="type">
            <option value="customers">Customers</option>
            <option value="products">Products</option>
            <option value="suppliers">Suppliers</option>
        </select>

    </div>
    <div id="result">

    </div>
    <script>
        async function getData() {
            const type = document.getElementById('type').value;
            const limit = document.getElementById('limit').value;
            const resultDiv = document.getElementById('result');

            try {
                const response = await axios.get(`/data?type=${type}&limit=${limit}`);
                const data = response.data.records;

                if (!data || data.length === 0) {
                    resultDiv.innerHTML = `<p class="text-danger">No data found.</p>`;
                    return;
                }

                let header = `<h2>${type}</h2>`;

                // Build table dynamically
                let table = '<table class="table table-striped">';
                // Table header
                // table += '<thead><tr>';
                // Object.keys(data[0]).forEach(key => {
                //     table += `<th>${key}</th>`;
                // });
                // table += '</tr></thead>';

                // Table body
                table += '<tbody>';
                // Table header
                table += '<tr>';
                Object.keys(data[0]).forEach(key => {
                    table += `<th>${key}</th>`;
                });
                table += '</tr>';
                data.forEach(item => {
                    table += '<tr>';
                    Object.values(item).forEach(value => {
                        table += `<td>${value}</td>`;
                    });
                    table += '</tr>';
                });
                table += '</tbody></table>';

                resultDiv.innerHTML = header + table;

            } catch (err) {
                console.error(err);
                resultDiv.innerHTML = `<p class="text-danger">Failed to fetch data.</p>`;
            }
        }

    </script>
</body>

</html>